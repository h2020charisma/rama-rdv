
tasks:
  - source: tasks/calibration.py
    product: 
      nb: "{{output_folder}}/calibration/calibration.ipynb"
      data: "{{output_folder}}/calibration/calibration_{{laser_wl4calibration}}.cha"
    params:
      laser_wl: "{{laser_wl4calibration}}"

  - source: tasks/calibration_load.py
    product: 
      nb: "{{output_folder}}/calibration/calibration_load.ipynb"
      data: "{{output_folder}}/calibration/source"
    params:
      laser_wl: "{{laser_wl4calibration}}"
      test_only: False    
      neon_file: "{{neon_file}}"
      silicon_file: "{{silicon_file}}"

  - source: tasks/calibration_apply.py
    product: 
      nb: "{{output_folder}}/calibration/calibration_apply.ipynb"
      data: "{{output_folder}}/calibration/results"
    params:
      laser_wl: "{{laser_wl4calibration}}"
      test_only: False
      input_file: "{{input_file}}"
      sample: "PST"

  - source: tasks/calibration_neon.py
    product: 
      nb: "{{output_folder}}/calibration/calibration_neon.ipynb"
      data:  "{{calibrated_files}}"
      model: "{{output_folder}}/{{calibration_file}}"
    params:
      laser_wl: "{{laser_wl4calibration}}"
      input_file: "{{input_file}}"
      prominence_coeff: "{{prominence_coeff}}"

  - source: tasks/calibration_nexus.py
    product: 
      nb: "{{output_folder}}/calibration/calibration_nexus.ipynb"
      nexus: "{{output_folder}}/calibration/carlibration.nxs"
    params:
      input_file: "{{input_file}}"
      calibration_file: "{{output_folder}}/{{calibration_file}}"
  